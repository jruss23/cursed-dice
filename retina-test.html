<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retina Text Sharpness Test</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, Arial, sans-serif;
      background: #0a0a1a;
      color: #fff;
      padding: 20px;
    }
    h1 { text-align: center; margin-bottom: 15px; color: #aa88ff; }
    .info {
      background: #1a1a2e;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
    }
    .info code { background: #2a2a4a; padding: 2px 6px; border-radius: 4px; color: #ffaa66; }

    .row-label {
      text-align: center;
      padding: 10px;
      margin: 20px 0 10px;
      font-size: 18px;
      font-weight: bold;
    }
    .row-label.current { color: #88ff88; }
    .row-label.alt { color: #ffaa66; }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }
    .panel {
      background: #1a1a2e;
      padding: 10px;
      border-radius: 8px;
      border: 2px solid #333;
    }
    .panel h2 {
      text-align: center;
      margin-bottom: 8px;
      padding: 6px;
      border-radius: 4px;
      font-size: 14px;
    }
    .panel.dpr1 h2 { background: #2a2a4a; color: #aaaaaa; }
    .panel.dpr2 h2 { background: #2a3a4a; color: #88aaff; }
    .panel.dpr3 h2 { background: #3a2a4a; color: #ff88ff; }

    .game-container {
      background: #0a0a1a;
      border-radius: 4px;
      min-height: 350px;
    }
    .game-container canvas { display: block; }

    @media (max-width: 900px) {
      .grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <h1>Retina Text Sharpness Test</h1>

  <div class="info">
    <p>Your native DPR: <code id="native-dpr"></code> | Each column simulates a specific DPR</p>
  </div>

  <div class="row-label current">ROW 1: Current Game Implementation (resolution = DPR × 2)</div>
  <div class="grid">
    <div class="panel dpr1">
      <h2>DPR 1 → res: 2</h2>
      <div id="current-dpr1" class="game-container"></div>
    </div>
    <div class="panel dpr2">
      <h2>DPR 2 → res: 4</h2>
      <div id="current-dpr2" class="game-container"></div>
    </div>
    <div class="panel dpr3">
      <h2>DPR 3 → res: 6</h2>
      <div id="current-dpr3" class="game-container"></div>
    </div>
  </div>

  <div class="row-label alt">ROW 2: Alternative - Fixed res: 4 (for all DPRs)</div>
  <div class="grid">
    <div class="panel dpr1">
      <h2>DPR 1 → res: 4</h2>
      <div id="alt-dpr1" class="game-container"></div>
    </div>
    <div class="panel dpr2">
      <h2>DPR 2 → res: 4</h2>
      <div id="alt-dpr2" class="game-container"></div>
    </div>
    <div class="panel dpr3">
      <h2>DPR 3 → res: 4</h2>
      <div id="alt-dpr3" class="game-container"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3.90.0/dist/phaser.min.js"></script>
  <script>
    document.getElementById('native-dpr').textContent = window.devicePixelRatio.toFixed(2);

    const WIDTH = 300;
    const HEIGHT = 350;
    const SYS_FONT = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial';

    const TEXT_SAMPLES = [
      { text: 'CURSED DICE', size: 28, y: 40 },
      { text: 'Score: 1,250', size: 20, y: 80 },
      { text: 'Choose Your Fate', size: 16, y: 115 },
      { text: 'Roll the dice to begin', size: 14, y: 145 },
      { text: 'Rerolls remaining: 3', size: 13, y: 175 },
      { text: 'SCOsco 0123456789', size: 14, y: 210 },
      { text: 'ABCDEFGHIJKLMNOP', size: 12, y: 240 },
      { text: 'Smooth curves test', size: 11, y: 270 },
      { text: 'qrstuvwxyz', size: 10, y: 295 },
    ];

    // =========================================================================
    // ROW 1: CURRENT GAME IMPLEMENTATION (resolution = DPR × 2)
    // =========================================================================

    class CurrentScene extends Phaser.Scene {
      constructor(key, simulatedDPR) {
        super({ key });
        this.simulatedDPR = simulatedDPR;
        this.resolution = simulatedDPR * 2; // Game uses DPR × 2
      }

      create() {
        this.add.rectangle(WIDTH/2, HEIGHT/2, WIDTH, HEIGHT, 0x0a0a1a);

        TEXT_SAMPLES.forEach(s => {
          this.add.text(WIDTH/2, s.y, s.text, {
            fontSize: s.size + 'px',
            fontFamily: SYS_FONT,
            color: '#ffffff',
            resolution: this.resolution,
            padding: { x: 4, y: 4 }
          }).setOrigin(0.5, 0.5);
        });

        // Label
        this.add.text(6, HEIGHT - 16, `DPR ${this.simulatedDPR} × 2 = res: ${this.resolution}`, {
          fontSize: '9px',
          color: '#88ff88',
          resolution: this.resolution
        });
      }
    }

    // =========================================================================
    // ROW 2: ALTERNATIVE - Fixed resolution: 4
    // =========================================================================

    class AltScene extends Phaser.Scene {
      constructor(key, simulatedDPR) {
        super({ key });
        this.simulatedDPR = simulatedDPR;
        this.resolution = 4; // Fixed at 4
      }

      create() {
        this.add.rectangle(WIDTH/2, HEIGHT/2, WIDTH, HEIGHT, 0x0a0a1a);

        TEXT_SAMPLES.forEach(s => {
          this.add.text(WIDTH/2, s.y, s.text, {
            fontSize: s.size + 'px',
            fontFamily: SYS_FONT,
            color: '#ffffff',
            resolution: this.resolution,
            padding: { x: 4, y: 4 }
          }).setOrigin(0.5, 0.5);
        });

        // Label
        this.add.text(6, HEIGHT - 16, `Fixed res: ${this.resolution}`, {
          fontSize: '9px',
          color: '#ffaa66',
          resolution: this.resolution
        });
      }
    }

    // =========================================================================
    // CREATE GAMES
    // =========================================================================

    const baseConfig = {
      type: Phaser.WEBGL,
      backgroundColor: 0x0a0a1a,
      scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
        width: WIDTH,
        height: HEIGHT,
      },
      render: {
        antialias: true,
        antialiasGL: true,
        pixelArt: false,
        roundPixels: false,
      },
    };

    // Row 1: Current game implementation (DPR × 2)
    class Current1 extends CurrentScene { constructor() { super('Current1', 1); } }
    class Current2 extends CurrentScene { constructor() { super('Current2', 2); } }
    class Current3 extends CurrentScene { constructor() { super('Current3', 3); } }

    new Phaser.Game({ ...baseConfig, parent: 'current-dpr1', scene: Current1 });
    new Phaser.Game({ ...baseConfig, parent: 'current-dpr2', scene: Current2 });
    new Phaser.Game({ ...baseConfig, parent: 'current-dpr3', scene: Current3 });

    // Row 2: Fixed resolution 4
    class Alt1 extends AltScene { constructor() { super('Alt1', 1); } }
    class Alt2 extends AltScene { constructor() { super('Alt2', 2); } }
    class Alt3 extends AltScene { constructor() { super('Alt3', 3); } }

    new Phaser.Game({ ...baseConfig, parent: 'alt-dpr1', scene: Alt1 });
    new Phaser.Game({ ...baseConfig, parent: 'alt-dpr2', scene: Alt2 });
    new Phaser.Game({ ...baseConfig, parent: 'alt-dpr3', scene: Alt3 });

  </script>
</body>
</html>
