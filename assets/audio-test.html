<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio Test Page - Cursed Dice</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    h1 { color: #a855f7; margin-bottom: 10px; }
    h2 { color: #22c55e; margin-top: 30px; border-bottom: 1px solid #333; padding-bottom: 10px; }
    h3 { color: #f59e0b; margin: 0 0 15px 0; }
    .section { background: #252540; padding: 20px; border-radius: 8px; margin: 15px 0; }

    /* Base files row */
    .base-files {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .base-file {
      flex: 1;
      min-width: 200px;
    }
    .base-file label {
      display: block;
      font-weight: 500;
      margin-bottom: 8px;
    }

    /* 3 column mode layout */
    .modes-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    @media (max-width: 900px) {
      .modes-grid { grid-template-columns: 1fr; }
    }
    .mode-col {
      background: #1a1a2e;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #333;
    }
    .mode-col.chill { border-color: #22c55e; }
    .mode-col.normal { border-color: #f59e0b; }
    .mode-col.intense { border-color: #ef4444; }
    .mode-col h3.chill { color: #22c55e; }
    .mode-col h3.normal { color: #f59e0b; }
    .mode-col h3.intense { color: #ef4444; }

    .audio-item {
      margin: 12px 0;
    }
    .audio-item label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
    }
    .audio-item small {
      color: #888;
      font-size: 11px;
    }
    .audio-item audio {
      width: 100%;
      height: 36px;
    }

    .final-output {
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #444;
    }
    .final-output label {
      font-weight: bold;
      color: #a855f7;
    }

    .effects-note {
      font-size: 10px;
      color: #666;
      font-family: monospace;
      margin-top: 10px;
      padding: 8px;
      background: #252540;
      border-radius: 4px;
    }

    .status {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 3px;
      margin-left: 8px;
    }
    .status.exists { background: #166534; }
    .status.missing { background: #991b1b; }
  </style>
</head>
<body>
  <h1>Audio Test Page</h1>
  <p>Test and compare audio files before stitching.</p>

  <!-- Base Source Files -->
  <h2>Source Files</h2>
  <div class="section">
    <div class="base-files">
      <div class="base-file">
        <label>Keep.mp3</label>
        <audio controls src="sounds/test-sources/Keep.mp3"></audio>
      </div>
      <div class="base-file">
        <label>Beware.mp3</label>
        <audio controls src="sounds/test-sources/Beware.mp3"></audio>
      </div>
      <div class="base-file">
        <label>Battling.mp3</label>
        <audio controls src="sounds/test-sources/Battling.mp3"></audio>
      </div>
      <div class="base-file">
        <label>Dungeon.mp3</label>
        <audio controls src="sounds/test-sources/Dungeon.mp3"></audio>
      </div>
    </div>
  </div>

  <!-- Menu Music -->
  <h2>Menu Music</h2>
  <div class="section">
    <div class="base-files">
      <div class="base-file">
        <label>Original</label>
        <audio controls src="sounds/test-sources/menu_original.mp3"></audio>
      </div>
      <div class="base-file">
        <label>Processed <small>4 steps down, chorus, reverb</small></label>
        <audio controls src="sounds/test-sources/menu_processed.mp3"></audio>
      </div>
      <div class="base-file">
        <label>In Game</label>
        <audio controls src="sounds/menu.mp3"></audio>
      </div>
    </div>
  </div>

  <!-- Modes Grid -->
  <h2>Processed by Mode</h2>
  <div class="section">
    <div class="modes-grid">

      <!-- Chill Mode -->
      <div class="mode-col chill">
        <h3 class="chill">Chill Mode</h3>

        <div class="audio-item">
          <label>Keep <small>2 min</small></label>
          <audio controls src="sounds/test-sources/chill_keep.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Beware <small>1 min, 6 steps down, slower</small></label>
          <audio controls src="sounds/test-sources/chill_beware.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Battling <small>1 min, +50% vol</small></label>
          <audio controls src="sounds/test-sources/chill_battling.mp3"></audio>
        </div>

        <div class="final-output">
          <div class="audio-item">
            <label>chill.mp3 <small>4 min total</small></label>
            <audio controls src="sounds/chill.mp3"></audio>
          </div>
        </div>

        <div class="effects-note">
          Base: 4 steps down, normal speed, chorus, reverb
        </div>
      </div>

      <!-- Normal Mode -->
      <div class="mode-col normal">
        <h3 class="normal">Normal Mode</h3>

        <div class="audio-item">
          <label>Keep <small>1 min</small></label>
          <audio controls src="sounds/test-sources/normal_keep.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Beware <small>1 min</small></label>
          <audio controls src="sounds/test-sources/normal_beware.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Battling <small>1 min</small></label>
          <audio controls src="sounds/test-sources/normal_battling.mp3"></audio>
        </div>

        <div class="final-output">
          <div class="audio-item">
            <label>normal.mp3 <small>3 min total</small></label>
            <audio controls src="sounds/normal.mp3"></audio>
          </div>
        </div>

        <div class="effects-note">
          Base effects + 15% faster
        </div>
      </div>

      <!-- Intense Mode -->
      <div class="mode-col intense">
        <h3 class="intense">Intense Mode</h3>

        <div class="audio-item">
          <label>Keep <small>30 sec</small></label>
          <audio controls src="sounds/test-sources/intense_keep.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Beware <small>30 sec</small></label>
          <audio controls src="sounds/test-sources/intense_beware.mp3"></audio>
        </div>
        <div class="audio-item">
          <label>Battling <small>1 min</small></label>
          <audio controls src="sounds/test-sources/intense_battling.mp3"></audio>
        </div>

        <div class="final-output">
          <div class="audio-item">
            <label>intense.mp3 <small>2 min total</small></label>
            <audio controls src="sounds/intense.mp3"></audio>
          </div>
        </div>

        <div class="effects-note">
          Base effects + 30% faster
        </div>
      </div>

    </div>
  </div>

  <script>
    const allAudio = document.querySelectorAll('audio');

    // Only allow one audio to play at a time
    allAudio.forEach(audio => {
      audio.addEventListener('play', () => {
        allAudio.forEach(other => {
          if (other !== audio) other.pause();
        });
      });
    });

    // Show duration status
    allAudio.forEach(audio => {
      audio.addEventListener('error', () => {
        const item = audio.closest('.audio-item, .base-file');
        if (item && !item.querySelector('.status')) {
          const status = document.createElement('span');
          status.className = 'status missing';
          status.textContent = 'missing';
          item.querySelector('label').appendChild(status);
        }
      });
      audio.addEventListener('loadeddata', () => {
        const item = audio.closest('.audio-item, .base-file');
        if (item && !item.querySelector('.status')) {
          const status = document.createElement('span');
          status.className = 'status exists';
          status.textContent = `${Math.round(audio.duration)}s`;
          item.querySelector('label').appendChild(status);
        }
      });
    });
  </script>
</body>
</html>
